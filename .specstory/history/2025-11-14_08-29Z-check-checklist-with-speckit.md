<!-- Generated by SpecStory, Markdown v2.0.0 -->

<!-- cursor Session 6c410a1e-f891-407a-864c-cedd5de79323 (2025-11-14 08:29Z) -->

# Check checklist with speckit (2025-11-14 08:29Z)

_**User (2025-11-14 08:30Z)**_

/speckit.checklist 

--- Cursor Command: speckit.checklist.md ---
---
description: Generate a custom checklist for the current feature based on user requirements.
---

## Checklist Purpose: "Unit Tests for English"

**CRITICAL CONCEPT**: Checklists are **UNIT TESTS FOR REQUIREMENTS WRITING** - they validate the quality, clarity, and completeness of requirements in a given domain.

**NOT for verification/testing**:

- âŒ NOT "Verify the button clicks correctly"
- âŒ NOT "Test error handling works"
- âŒ NOT "Confirm the API returns 200"
- âŒ NOT checking if code/implementation matches the spec

**FOR requirements quality validation**:

- âœ… "Are visual hierarchy requirements defined for all card types?" (completeness)
- âœ… "Is 'prominent display' quantified with specific sizing/positioning?" (clarity)
- âœ… "Are hover state requirements consistent across all interactive elements?" (consistency)
- âœ… "Are accessibility requirements defined for keyboard navigation?" (coverage)
- âœ… "Does the spec define what happens when logo image fails to load?" (edge cases)

**Metaphor**: If your spec is code written in English, the checklist is its unit test suite. You're testing whether the requirements are well-written, complete, unambiguous, and ready for implementation - NOT whether the implementation works.

## User Input

```text
$ARGUMENTS
```

You **MUST** consider the user input before proceeding (if not empty).

## Execution Steps

1. **Setup**: Run `.specify/scripts/bash/check-prerequisites.sh --json` from repo root and parse JSON for FEATURE_DIR and AVAILABLE_DOCS list.
   - All file paths must be absolute.
   - For single quotes in args like "I'm Groot", use escape syntax: e.g 'I'\''m Groot' (or double-quote if possible: "I'm Groot").

2. **Clarify intent (dynamic)**: Derive up to THREE initial contextual clarifying questions (no pre-baked catalog). They MUST:
   - Be generated from the user's phrasing + extracted signals from spec/plan/tasks
   - Only ask about information that materially changes checklist content
   - Be skipped individually if already unambiguous in `$ARGUMENTS`
   - Prefer precision over breadth

   Generation algorithm:
   1. Extract signals: feature domain keywords (e.g., auth, latency, UX, API), risk indicators ("critical", "must", "compliance"), stakeholder hints ("QA", "review", "security team"), and explicit deliverables ("a11y", "rollback", "contracts").
   2. Cluster signals into candidate focus areas (max 4) ranked by relevance.
   3. Identify probable audience & timing (author, reviewer, QA, release) if not explicit.
   4. Detect missing dimensions: scope breadth, depth/rigor, risk emphasis, exclusion boundaries, measurable acceptance criteria.
   5. Formulate questions chosen from these archetypes:
      - Scope refinement (e.g., "Should this include integration touchpoints with X and Y or stay limited to local module correctness?")
      - Risk prioritization (e.g., "Which of these potential risk areas should receive mandatory gating checks?")
      - Depth calibration (e.g., "Is this a lightweight pre-commit sanity list or a formal release gate?")
      - Audience framing (e.g., "Will this be used by the author only or peers during PR review?")
      - Boundary exclusion (e.g., "Should we explicitly exclude performance tuning items this round?")
      - Scenario class gap (e.g., "No recovery flows detectedâ€”are rollback / partial failure paths in scope?")

   Question formatting rules:
   - If presenting options, generate a compact table with columns: Option | Candidate | Why It Matters
   - Limit to Aâ€“E options maximum; omit table if a free-form answer is clearer
   - Never ask the user to restate what they already said
   - Avoid speculative categories (no hallucination). If uncertain, ask explicitly: "Confirm whether X belongs in scope."

   Defaults when interaction impossible:
   - Depth: Standard
   - Audience: Reviewer (PR) if code-related; Author otherwise
   - Focus: Top 2 relevance clusters

   Output the questions (label Q1/Q2/Q3). After answers: if â‰¥2 scenario classes (Alternate / Exception / Recovery / Non-Functional domain) remain unclear, you MAY ask up to TWO more targeted followâ€‘ups (Q4/Q5) with a one-line justification each (e.g., "Unresolved recovery path risk"). Do not exceed five total questions. Skip escalation if user explicitly declines more.

3. **Understand user request**: Combine `$ARGUMENTS` + clarifying answers:
   - Derive checklist theme (e.g., security, review, deploy, ux)
   - Consolidate explicit must-have items mentioned by user
   - Map focus selections to category scaffolding
   - Infer any missing context from spec/plan/tasks (do NOT hallucinate)

4. **Load feature context**: Read from FEATURE_DIR:
   - spec.md: Feature requirements and scope
   - plan.md (if exists): Technical details, dependencies
   - tasks.md (if exists): Implementation tasks

   **Context Loading Strategy**:
   - Load only necessary portions relevant to active focus areas (avoid full-file dumping)
   - Prefer summarizing long sections into concise scenario/requirement bullets
   - Use progressive disclosure: add follow-on retrieval only if gaps detected
   - If source docs are large, generate interim summary items instead of embedding raw text

5. **Generate checklist** - Create "Unit Tests for Requirements":
   - Create `FEATURE_DIR/checklists/` directory if it doesn't exist
   - Generate unique checklist filename:
     - Use short, descriptive name based on domain (e.g., `ux.md`, `api.md`, `security.md`)
     - Format: `[domain].md`
     - If file exists, append to existing file
   - Number items sequentially starting from CHK001
   - Each `/speckit.checklist` run creates a NEW file (never overwrites existing checklists)

   **CORE PRINCIPLE - Test the Requirements, Not the Implementation**:
   Every checklist item MUST evaluate the REQUIREMENTS THEMSELVES for:
   - **Completeness**: Are all necessary requirements present?
   - **Clarity**: Are requirements unambiguous and specific?
   - **Consistency**: Do requirements align with each other?
   - **Measurability**: Can requirements be objectively verified?
   - **Coverage**: Are all scenarios/edge cases addressed?

   **Category Structure** - Group items by requirement quality dimensions:
   - **Requirement Completeness** (Are all necessary requirements documented?)
   - **Requirement Clarity** (Are requirements specific and unambiguous?)
   - **Requirement Consistency** (Do requirements align without conflicts?)
   - **Acceptance Criteria Quality** (Are success criteria measurable?)
   - **Scenario Coverage** (Are all flows/cases addressed?)
   - **Edge Case Coverage** (Are boundary conditions defined?)
   - **Non-Functional Requirements** (Performance, Security, Accessibility, etc. - are they specified?)
   - **Dependencies & Assumptions** (Are they documented and validated?)
   - **Ambiguities & Conflicts** (What needs clarification?)

   **HOW TO WRITE CHECKLIST ITEMS - "Unit Tests for English"**:

   âŒ **WRONG** (Testing implementation):
   - "Verify landing page displays 3 episode cards"
   - "Test hover states work on desktop"
   - "Confirm logo click navigates home"

   âœ… **CORRECT** (Testing requirements quality):
   - "Are the exact number and layout of featured episodes specified?" [Completeness]
   - "Is 'prominent display' quantified with specific sizing/positioning?" [Clarity]
   - "Are hover state requirements consistent across all interactive elements?" [Consistency]
   - "Are keyboard navigation requirements defined for all interactive UI?" [Coverage]
   - "Is the fallback behavior specified when logo image fails to load?" [Edge Cases]
   - "Are loading states defined for asynchronous episode data?" [Completeness]
   - "Does the spec define visual hierarchy for competing UI elements?" [Clarity]

   **ITEM STRUCTURE**:
   Each item should follow this pattern:
   - Question format asking about requirement quality
   - Focus on what's WRITTEN (or not written) in the spec/plan
   - Include quality dimension in brackets [Completeness/Clarity/Consistency/etc.]
   - Reference spec section `[Spec Â§X.Y]` when checking existing requirements
   - Use `[Gap]` marker when checking for missing requirements

   **EXAMPLES BY QUALITY DIMENSION**:

   Completeness:
   - "Are error handling requirements defined for all API failure modes? [Gap]"
   - "Are accessibility requirements specified for all interactive elements? [Completeness]"
   - "Are mobile breakpoint requirements defined for responsive layouts? [Gap]"

   Clarity:
   - "Is 'fast loading' quantified with specific timing thresholds? [Clarity, Spec Â§NFR-2]"
   - "Are 'related episodes' selection criteria explicitly defined? [Clarity, Spec Â§FR-5]"
   - "Is 'prominent' defined with measurable visual properties? [Ambiguity, Spec Â§FR-4]"

   Consistency:
   - "Do navigation requirements align across all pages? [Consistency, Spec Â§FR-10]"
   - "Are card component requirements consistent between landing and detail pages? [Consistency]"

   Coverage:
   - "Are requirements defined for zero-state scenarios (no episodes)? [Coverage, Edge Case]"
   - "Are concurrent user interaction scenarios addressed? [Coverage, Gap]"
   - "Are requirements specified for partial data loading failures? [Coverage, Exception Flow]"

   Measurability:
   - "Are visual hierarchy requirements measurable/testable? [Acceptance Criteria, Spec Â§FR-1]"
   - "Can 'balanced visual weight' be objectively verified? [Measurability, Spec Â§FR-2]"

   **Scenario Classification & Coverage** (Requirements Quality Focus):
   - Check if requirements exist for: Primary, Alternate, Exception/Error, Recovery, Non-Functional scenarios
   - For each scenario class, ask: "Are [scenario type] requirements complete, clear, and consistent?"
   - If scenario class missing: "Are [scenario type] requirements intentionally excluded or missing? [Gap]"
   - Include resilience/rollback when state mutation occurs: "Are rollback requirements defined for migration failures? [Gap]"

   **Traceability Requirements**:
   - MINIMUM: â‰¥80% of items MUST include at least one traceability reference
   - Each item should reference: spec section `[Spec Â§X.Y]`, or use markers: `[Gap]`, `[Ambiguity]`, `[Conflict]`, `[Assumption]`
   - If no ID system exists: "Is a requirement & acceptance criteria ID scheme established? [Traceability]"

   **Surface & Resolve Issues** (Requirements Quality Problems):
   Ask questions about the requirements themselves:
   - Ambiguities: "Is the term 'fast' quantified with specific metrics? [Ambiguity, Spec Â§NFR-1]"
   - Conflicts: "Do navigation requirements conflict between Â§FR-10 and Â§FR-10a? [Conflict]"
   - Assumptions: "Is the assumption of 'always available podcast API' validated? [Assumption]"
   - Dependencies: "Are external podcast API requirements documented? [Dependency, Gap]"
   - Missing definitions: "Is 'visual hierarchy' defined with measurable criteria? [Gap]"

   **Content Consolidation**:
   - Soft cap: If raw candidate items > 40, prioritize by risk/impact
   - Merge near-duplicates checking the same requirement aspect
   - If >5 low-impact edge cases, create one item: "Are edge cases X, Y, Z addressed in requirements? [Coverage]"

   **ğŸš« ABSOLUTELY PROHIBITED** - These make it an implementation test, not a requirements test:
   - âŒ Any item starting with "Verify", "Test", "Confirm", "Check" + implementation behavior
   - âŒ References to code execution, user actions, system behavior
   - âŒ "Displays correctly", "works properly", "functions as expected"
   - âŒ "Click", "navigate", "render", "load", "execute"
   - âŒ Test cases, test plans, QA procedures
   - âŒ Implementation details (frameworks, APIs, algorithms)

   **âœ… REQUIRED PATTERNS** - These test requirements quality:
   - âœ… "Are [requirement type] defined/specified/documented for [scenario]?"
   - âœ… "Is [vague term] quantified/clarified with specific criteria?"
   - âœ… "Are requirements consistent between [section A] and [section B]?"
   - âœ… "Can [requirement] be objectively measured/verified?"
   - âœ… "Are [edge cases/scenarios] addressed in requirements?"
   - âœ… "Does the spec define [missing aspect]?"

6. **Structure Reference**: Generate the checklist following the canonical template in `.specify/templates/checklist-template.md` for title, meta section, category headings, and ID formatting. If template is unavailable, use: H1 title, purpose/created meta lines, `##` category sections containing `- [ ] CHK### <requirement item>` lines with globally incrementing IDs starting at CHK001.

7. **Report**: Output full path to created checklist, item count, and remind user that each run creates a new file. Summarize:
   - Focus areas selected
   - Depth level
   - Actor/timing
   - Any explicit user-specified must-have items incorporated

**Important**: Each `/speckit.checklist` command invocation creates a checklist file using short, descriptive names unless file already exists. This allows:

- Multiple checklists of different types (e.g., `ux.md`, `test.md`, `security.md`)
- Simple, memorable filenames that indicate checklist purpose
- Easy identification and navigation in the `checklists/` folder

To avoid clutter, use descriptive types and clean up obsolete checklists when done.

## Example Checklist Types & Sample Items

**UX Requirements Quality:** `ux.md`

Sample items (testing the requirements, NOT the implementation):

- "Are visual hierarchy requirements defined with measurable criteria? [Clarity, Spec Â§FR-1]"
- "Is the number and positioning of UI elements explicitly specified? [Completeness, Spec Â§FR-1]"
- "Are interaction state requirements (hover, focus, active) consistently defined? [Consistency]"
- "Are accessibility requirements specified for all interactive elements? [Coverage, Gap]"
- "Is fallback behavior defined when images fail to load? [Edge Case, Gap]"
- "Can 'prominent display' be objectively measured? [Measurability, Spec Â§FR-4]"

**API Requirements Quality:** `api.md`

Sample items:

- "Are error response formats specified for all failure scenarios? [Completeness]"
- "Are rate limiting requirements quantified with specific thresholds? [Clarity]"
- "Are authentication requirements consistent across all endpoints? [Consistency]"
- "Are retry/timeout requirements defined for external dependencies? [Coverage, Gap]"
- "Is versioning strategy documented in requirements? [Gap]"

**Performance Requirements Quality:** `performance.md`

Sample items:

- "Are performance requirements quantified with specific metrics? [Clarity]"
- "Are performance targets defined for all critical user journeys? [Coverage]"
- "Are performance requirements under different load conditions specified? [Completeness]"
- "Can performance requirements be objectively measured? [Measurability]"
- "Are degradation requirements defined for high-load scenarios? [Edge Case, Gap]"

**Security Requirements Quality:** `security.md`

Sample items:

- "Are authentication requirements specified for all protected resources? [Coverage]"
- "Are data protection requirements defined for sensitive information? [Completeness]"
- "Is the threat model documented and requirements aligned to it? [Traceability]"
- "Are security requirements consistent with compliance obligations? [Consistency]"
- "Are security failure/breach response requirements defined? [Gap, Exception Flow]"

## Anti-Examples: What NOT To Do

**âŒ WRONG - These test implementation, not requirements:**

```markdown
- [ ] CHK001 - Verify landing page displays 3 episode cards [Spec Â§FR-001]
- [ ] CHK002 - Test hover states work correctly on desktop [Spec Â§FR-003]
- [ ] CHK003 - Confirm logo click navigates to home page [Spec Â§FR-010]
- [ ] CHK004 - Check that related episodes section shows 3-5 items [Spec Â§FR-005]
```

**âœ… CORRECT - These test requirements quality:**

```markdown
- [ ] CHK001 - Are the number and layout of featured episodes explicitly specified? [Completeness, Spec Â§FR-001]
- [ ] CHK002 - Are hover state requirements consistently defined for all interactive elements? [Consistency, Spec Â§FR-003]
- [ ] CHK003 - Are navigation requirements clear for all clickable brand elements? [Clarity, Spec Â§FR-010]
- [ ] CHK004 - Is the selection criteria for related episodes documented? [Gap, Spec Â§FR-005]
- [ ] CHK005 - Are loading state requirements defined for asynchronous episode data? [Gap]
- [ ] CHK006 - Can "visual hierarchy" requirements be objectively measured? [Measurability, Spec Â§FR-001]
```

**Key Differences:**

- Wrong: Tests if the system works correctly
- Correct: Tests if the requirements are written correctly
- Wrong: Verification of behavior
- Correct: Validation of requirement quality
- Wrong: "Does it do X?"
- Correct: "Is X clearly specified?"

--- End Command ---

---

_**Agent (model gpt-5.1-codex, mode Agent)**_

<think><details><summary>Thought Process</summary>
**Preparing to run script**</details></think>

---

<tool-use data-tool-type="bash" data-tool-name="run_terminal_cmd">
<details><summary>Tool use: **command** â€¢ Run command: cd /Users/david_atlarge/Local Sites/speckit-eval/app && .specify/scripts/bash/check-prerequisites.sh --json</summary>

```bash
cd /Users/david_atlarge/Local Sites/speckit-eval/app && .specify/scripts/bash/check-prerequisites.sh --json
```

```
(eval):cd:1: no such file or directory: Sites/speckit-eval/app Sites/speckit-eval/app

```
</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Handling spaces in file paths**</details></think>

---

<tool-use data-tool-type="bash" data-tool-name="run_terminal_cmd">
<details><summary>Tool use: **command** â€¢ Run command: cd '/Users/david_atlarge/Local Sites/speckit-eval/app' && .specify/scripts/bash/check-prerequisites.sh --json</summary>

```bash
cd '/Users/david_atlarge/Local Sites/speckit-eval/app' && .specify/scripts/bash/check-prerequisites.sh --json
```

```
{&quot;FEATURE_DIR&quot;:&quot;/Users/david_atlarge/Local Sites/speckit-eval/app/specs/001-cookie-consent&quot;,&quot;AVAILABLE_DOCS&quot;:[&quot;research.md&quot;,&quot;data-model.md&quot;,&quot;contracts/&quot;,&quot;quickstart.md&quot;]}

```
</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Formulating clarifying questions**</details></think>

---

David, before I generate the requirements-quality checklist I need a bit more context:

Q1  
Option | Candidate | Why It Matters  
A | Multi-region compliance (GDPR, CCPA, etc.) | Changes which regulatory scenarios the checklist must validate for completeness  
B | EU-only (GDPR + ePrivacy) | Narrows scope to fewer legal frameworks, affecting coverage items  
C | Generic best-practice consent (no jurisdiction specifics) | Focuses on UX clarity over legal completeness  
Which option matches the intended scope?

Q2  
Do the requirements need to spell out lifecycle flows such as consent withdrawal, re-prompting after policy updates, and audit logging, or are we limiting this checklist to first-visit consent capture?

Q3  
Should accessibility and performance non-functional requirements for the consent banner be explicitly included in this checklist, or handled elsewhere?

---

_**User (2025-11-14 08:30Z)**_

B

---

_**Agent (model gpt-5.1-codex, mode Agent)**_

<think><details><summary>Thought Process</summary>
**Checking for specification files**</details></think>

---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_directory** â€¢ Listed directory undefined â€¢ **0** results</summary>
        
No results found
</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Looking for specification or plan**</details></think>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** â€¢ Read file: /Users/david_atlarge/Local Sites/speckit-eval/app/specs/001-cookie-consent/spec.md</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Reviewing task plan**</details></think>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** â€¢ Read file: /Users/david_atlarge/Local Sites/speckit-eval/app/specs/001-cookie-consent/plan.md</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Evaluating data model needs and assumptions**</details></think>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** â€¢ Read file: /Users/david_atlarge/Local Sites/speckit-eval/app/.specify/templates/checklist-template.md</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Organizing compliance checklist content**</details></think>

---

<tool-use data-tool-type="bash" data-tool-name="run_terminal_cmd">
<details><summary>Tool use: **command** â€¢ Run command: cd '/Users/david_atlarge/Local Sites/speckit-eval/app' && cat <<'EOF' > 'specs/001-cookie-consent/checklists/compliance.md'
# Compliance Checklist: Cookie Consent Manager

**Purpose**: Unit-test the written GDPR/ePrivacy consent requirements for completeness, clarity, and readiness before implementation.
**Created**: 2025-11-14
**Feature**: [spec.md](../spec.md)

**Note**: This checklist is generated by the `/speckit.checklist` command based on feature context and requirements.

## Requirement Completeness

- [ ] CHK001 Are GDPR/ePrivacy legal obligations for initial consent, rejection, and essential-cookie justification explicitly documented for each banner action? [Completeness, Spec Â§User Story 1]
- [ ] CHK002 Are all lifecycle touchpoints (initial capture, category selection, preference edits, re-prompts) mapped to specific functional requirements without gaps between FR-001â€“FR-014? [Completeness, Spec Â§FR-001â€“FR-014]
- [ ] CHK003 Are consent log retention expectations paired with defined data fields (timestamp, categories, consent version, identifiers) so auditors know what must be recorded? [Completeness, Spec Â§FR-013]
- [ ] CHK004 Are administrator workflows for onboarding new cookies (detection, categorization, approval) fully specified beyond the assumption that site owners supply data? [Completeness, Spec Â§Assumptions]
- [ ] CHK005 Are user-visible banner states for both consented and non-consented visitors described for desktop and mobile breakpoints? [Gap]

## Requirement Clarity

- [ ] CHK006 Is the term â€œnon-essential cookieâ€ defined with objective criteria or examples so implementers know which scripts must be blocked? [Clarity, Spec Â§FR-003]
- [ ] CHK007 Is â€œpermanently dismissedâ€ quantified (timeframe, storage TTL) to avoid ambiguity about reappearance timing? [Clarity, Spec Â§User Story 1]
- [ ] CHK008 Are cookie category descriptions standardized (tone, length, legal phrasing) to ensure consistent transparency messaging? [Clarity, Spec Â§FR-005]
- [ ] CHK009 Is the â€œnoticeable without blocking contentâ€ banner requirement translated into measurable layout specs (height, contrast, spacing) for designers? [Clarity, Spec Â§FR-015]

## Requirement Consistency

- [ ] CHK010 Do blocking requirements stay consistent between FR-003â€™s script wrapper approach and Edge Case guidance for JavaScript-disabled visitors? [Consistency, Spec Â§FR-003 & Edge Cases]
- [ ] CHK011 Are storage mechanism descriptions (localStorage + cookie identifier) aligned between FR-004, Key Entities, and Success Criteria without conflicting persistence rules? [Consistency, Spec Â§FR-004 & Key Entities]
- [ ] CHK012 Is the re-prompt expectation in User Story 3 Scenario 5 aligned with FR-014 so users are not over/under-prompted? [Consistency, Spec Â§User Story 3 & Â§FR-014]
- [ ] CHK013 Does the â€œno re-prompt for 12 monthsâ€ success metric (SC-003) coexist logically with change-driven re-prompts, and is precedence stated? [Consistency, Spec Â§SC-003 & Â§FR-014]

## Acceptance Criteria Quality

- [ ] CHK014 Are acceptance scenarios for each user story linked to measurable signals (e.g., cookie counts blocked, state persistence) instead of qualitative statements? [Acceptance Criteria, Spec Â§User Stories]
- [ ] CHK015 Do success criteria specify how to measure timings such as â€œdecision in under 10 secondsâ€ and â€œbanner loads within 1 secondâ€ (tooling, sampling, environments)? [Acceptance Criteria, Spec Â§SC-002 & Â§SC-006]
- [ ] CHK016 Is â€œconsent persists 12 monthsâ€ backed by explicit storage expiration rules and validation steps? [Acceptance Criteria, Spec Â§SC-003]
- [ ] CHK017 Are audit-log verification steps defined so â€œ100% of consent events capturedâ€ can be proven (e.g., reconciliation process)? [Acceptance Criteria, Spec Â§SC-010]

## Scenario Coverage

- [ ] CHK018 Are automatic rejection flows triggered by Do Not Track fully described, including messaging and overrides? [Coverage, Spec Â§FR-012]
- [ ] CHK019 Are partial-consent scenarios (accept functional, reject marketing) covered with expected UI states and cookie enforcement details? [Coverage, Spec Â§User Story 2]
- [ ] CHK020 Are preference-change flows for Acceptâ†’Reject, Rejectâ†’Accept, and per-category toggles described with resulting cookie cleanup steps? [Coverage, Spec Â§User Story 3]
- [ ] CHK021 Are admin-driven cookie catalog updates (new cookies, reclassified purposes) paired with user-facing notifications and re-consent logic? [Coverage, Spec Â§User Story 3 Scenario 5]

## Edge Case Coverage

- [ ] CHK022 Is the JavaScript-disabled fallback detailed enough (UI content, localization, essential-cookie list) for implementation? [Edge Case Coverage, Spec Â§Edge Cases]
- [ ] CHK023 Are scenarios for cleared browser data or private browsing sessions defined so consent state resets behave consistently? [Edge Case Coverage, Spec Â§Edge Cases]
- [ ] CHK024 Are rules for embedded third-party content (iframes, widgets) described, including how blocked content is communicated prior to consent? [Edge Case Coverage, Spec Â§Edge Cases]
- [ ] CHK025 Is there guidance for conflicts when a cookieâ€™s purpose or category changes mid-session (retroactive consent, user notification)? [Edge Case Coverage, Spec Â§Edge Cases]

## Non-Functional Requirements

- [ ] CHK026 Are performance budgets for consent checks (<50ms) and banner rendering (<1s) traced to environments and monitoring strategies? [Non-Functional, Spec Â§SC-006 & Plan Â§Technical Context]
- [ ] CHK027 Are accessibility requirements (keyboard focus order, ARIA labels, focus trapping) explicitly listed for banner and modal states? [Non-Functional, Spec Â§SC-009]
- [ ] CHK028 Are resilience expectations for log storage (3-year retention, backup cadence, PII handling) documented? [Non-Functional, Spec Â§FR-013]
- [ ] CHK029 Are mobile responsiveness constraints (breakpoints, touch-target sizes) specified to validate SC-009 beyond general statements? [Non-Functional, Spec Â§SC-009]

## Dependencies & Assumptions

- [ ] CHK030 Are assumptions about administrators supplying accurate cookie metadata backed by contingency plans if data is missing or outdated? [Dependencies, Spec Â§Assumptions]
- [ ] CHK031 Are dependencies on WordPress roles, Etch theme hooks, and AutomaticCSS utilities documented so non-Etch environments are clearly out of scope? [Dependencies, Plan Â§Technical Context]
- [ ] CHK032 Are legal content dependencies (privacy policy text, banner copy) identified with ownership and delivery timelines? [Dependencies, Spec Â§Assumptions]

## Ambiguities & Conflicts

- [ ] CHK033 Is precedence defined between consent persistence guarantees (12 months) and change-triggered re-prompts to avoid stakeholder disputes? [Conflict, Spec Â§SC-003 & Â§FR-014]
- [ ] CHK034 Is â€œimmediatelyâ€ (preference save effects) quantified with technical constraints (latency, async processing) to prevent subjective interpretations? [Ambiguity, Spec Â§User Story 3]
- [ ] CHK035 Is â€œnoticeable without blocking contentâ€ reconciled with accessibility contrast requirements to avoid conflicting design directions? [Ambiguity, Spec Â§FR-015 & Â§SC-009]

## Notes

- Check items off as completed: `[x]`
- Add comments or findings inline
- Link to relevant resources or documentation
- Items are numbered sequentially for easy reference
EOF</summary>

```bash
cd '/Users/david_atlarge/Local Sites/speckit-eval/app' && cat <<'EOF' > 'specs/001-cookie-consent/checklists/compliance.md'
# Compliance Checklist: Cookie Consent Manager

**Purpose**: Unit-test the written GDPR/ePrivacy consent requirements for completeness, clarity, and readiness before implementation.
**Created**: 2025-11-14
**Feature**: [spec.md](../spec.md)

**Note**: This checklist is generated by the `/speckit.checklist` command based on feature context and requirements.

## Requirement Completeness

- [ ] CHK001 Are GDPR/ePrivacy legal obligations for initial consent, rejection, and essential-cookie justification explicitly documented for each banner action? [Completeness, Spec Â§User Story 1]
- [ ] CHK002 Are all lifecycle touchpoints (initial capture, category selection, preference edits, re-prompts) mapped to specific functional requirements without gaps between FR-001â€“FR-014? [Completeness, Spec Â§FR-001â€“FR-014]
- [ ] CHK003 Are consent log retention expectations paired with defined data fields (timestamp, categories, consent version, identifiers) so auditors know what must be recorded? [Completeness, Spec Â§FR-013]
- [ ] CHK004 Are administrator workflows for onboarding new cookies (detection, categorization, approval) fully specified beyond the assumption that site owners supply data? [Completeness, Spec Â§Assumptions]
- [ ] CHK005 Are user-visible banner states for both consented and non-consented visitors described for desktop and mobile breakpoints? [Gap]

## Requirement Clarity

- [ ] CHK006 Is the term â€œnon-essential cookieâ€ defined with objective criteria or examples so implementers know which scripts must be blocked? [Clarity, Spec Â§FR-003]
- [ ] CHK007 Is â€œpermanently dismissedâ€ quantified (timeframe, storage TTL) to avoid ambiguity about reappearance timing? [Clarity, Spec Â§User Story 1]
- [ ] CHK008 Are cookie category descriptions standardized (tone, length, legal phrasing) to ensure consistent transparency messaging? [Clarity, Spec Â§FR-005]
- [ ] CHK009 Is the â€œnoticeable without blocking contentâ€ banner requirement translated into measurable layout specs (height, contrast, spacing) for designers? [Clarity, Spec Â§FR-015]

## Requirement Consistency

- [ ] CHK010 Do blocking requirements stay consistent between FR-003â€™s script wrapper approach and Edge Case guidance for JavaScript-disabled visitors? [Consistency, Spec Â§FR-003 & Edge Cases]
- [ ] CHK011 Are storage mechanism descriptions (localStorage + cookie identifier) aligned between FR-004, Key Entities, and Success Criteria without conflicting persistence rules? [Consistency, Spec Â§FR-004 & Key Entities]
- [ ] CHK012 Is the re-prompt expectation in User Story 3 Scenario 5 aligned with FR-014 so users are not over/under-prompted? [Consistency, Spec Â§User Story 3 & Â§FR-014]
- [ ] CHK013 Does the â€œno re-prompt for 12 monthsâ€ success metric (SC-003) coexist logically with change-driven re-prompts, and is precedence stated? [Consistency, Spec Â§SC-003 & Â§FR-014]

## Acceptance Criteria Quality

- [ ] CHK014 Are acceptance scenarios for each user story linked to measurable signals (e.g., cookie counts blocked, state persistence) instead of qualitative statements? [Acceptance Criteria, Spec Â§User Stories]
- [ ] CHK015 Do success criteria specify how to measure timings such as â€œdecision in under 10 secondsâ€ and â€œbanner loads within 1 secondâ€ (tooling, sampling, environments)? [Acceptance Criteria, Spec Â§SC-002 & Â§SC-006]
- [ ] CHK016 Is â€œconsent persists 12 monthsâ€ backed by explicit storage expiration rules and validation steps? [Acceptance Criteria, Spec Â§SC-003]
- [ ] CHK017 Are audit-log verification steps defined so â€œ100% of consent events capturedâ€ can be proven (e.g., reconciliation process)? [Acceptance Criteria, Spec Â§SC-010]

## Scenario Coverage

- [ ] CHK018 Are automatic rejection flows triggered by Do Not Track fully described, including messaging and overrides? [Coverage, Spec Â§FR-012]
- [ ] CHK019 Are partial-consent scenarios (accept functional, reject marketing) covered with expected UI states and cookie enforcement details? [Coverage, Spec Â§User Story 2]
- [ ] CHK020 Are preference-change flows for Acceptâ†’Reject, Rejectâ†’Accept, and per-category toggles described with resulting cookie cleanup steps? [Coverage, Spec Â§User Story 3]
- [ ] CHK021 Are admin-driven cookie catalog updates (new cookies, reclassified purposes) paired with user-facing notifications and re-consent logic? [Coverage, Spec Â§User Story 3 Scenario 5]

## Edge Case Coverage

- [ ] CHK022 Is the JavaScript-disabled fallback detailed enough (UI content, localization, essential-cookie list) for implementation? [Edge Case Coverage, Spec Â§Edge Cases]
- [ ] CHK023 Are scenarios for cleared browser data or private browsing sessions defined so consent state resets behave consistently? [Edge Case Coverage, Spec Â§Edge Cases]
- [ ] CHK024 Are rules for embedded third-party content (iframes, widgets) described, including how blocked content is communicated prior to consent? [Edge Case Coverage, Spec Â§Edge Cases]
- [ ] CHK025 Is there guidance for conflicts when a cookieâ€™s purpose or category changes mid-session (retroactive consent, user notification)? [Edge Case Coverage, Spec Â§Edge Cases]

## Non-Functional Requirements

- [ ] CHK026 Are performance budgets for consent checks (<50ms) and banner rendering (<1s) traced to environments and monitoring strategies? [Non-Functional, Spec Â§SC-006 & Plan Â§Technical Context]
- [ ] CHK027 Are accessibility requirements (keyboard focus order, ARIA labels, focus trapping) explicitly listed for banner and modal states? [Non-Functional, Spec Â§SC-009]
- [ ] CHK028 Are resilience expectations for log storage (3-year retention, backup cadence, PII handling) documented? [Non-Functional, Spec Â§FR-013]
- [ ] CHK029 Are mobile responsiveness constraints (breakpoints, touch-target sizes) specified to validate SC-009 beyond general statements? [Non-Functional, Spec Â§SC-009]

## Dependencies & Assumptions

- [ ] CHK030 Are assumptions about administrators supplying accurate cookie metadata backed by contingency plans if data is missing or outdated? [Dependencies, Spec Â§Assumptions]
- [ ] CHK031 Are dependencies on WordPress roles, Etch theme hooks, and AutomaticCSS utilities documented so non-Etch environments are clearly out of scope? [Dependencies, Plan Â§Technical Context]
- [ ] CHK032 Are legal content dependencies (privacy policy text, banner copy) identified with ownership and delivery timelines? [Dependencies, Spec Â§Assumptions]

## Ambiguities & Conflicts

- [ ] CHK033 Is precedence defined between consent persistence guarantees (12 months) and change-triggered re-prompts to avoid stakeholder disputes? [Conflict, Spec Â§SC-003 & Â§FR-014]
- [ ] CHK034 Is â€œimmediatelyâ€ (preference save effects) quantified with technical constraints (latency, async processing) to prevent subjective interpretations? [Ambiguity, Spec Â§User Story 3]
- [ ] CHK035 Is â€œnoticeable without blocking contentâ€ reconciled with accessibility contrast requirements to avoid conflicting design directions? [Ambiguity, Spec Â§FR-015 & Â§SC-009]

## Notes

- Check items off as completed: `[x]`
- Add comments or findings inline
- Link to relevant resources or documentation
- Items are numbered sequentially for easy reference
EOF
```
</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Composing detailed checklist summary**

I'm putting together a thorough final message summarizing the checklist with 35 itemsâ€”highlighting that only one lacks a spec reference and confirming over 80% coverage. I'll include the file path, focus areas like EU compliance and lifecycle coverage, and mention the default depth and actor. Iâ€™ll also note assumptions made due to unanswered questions, remind that each run creates a new file, and wrap it with a clear Markdown header and bullet points for easy reading.</details></think>

---

## Checklist Generated
- Created ` /Users/david_atlarge/Local Sites/speckit-eval/app/specs/001-cookie-consent/checklists/compliance.md` with 35 requirement-quality items; each `/speckit.checklist` run adds another file.
- Focus areas: EU (GDPR + ePrivacy) consent scope, consent lifecycle coverage, and non-functional (accessibility + performance) rigor per your initial input and spec priorities.
- Depth level: standard reviewer-oriented checklist (default because only Q1 was answered); intended for use during PR/spec reviews before build work starts.
- Incorporated must-haves: emphasized EU-only compliance framing, lifecycle requirements (capture, edits, re-prompts), and non-functional expectations (SC-002/006/009/010, Plan performance targets).
- Assumptions noted: treated preference lifecycle and a11y/perf requirements as in-scope since Q2/Q3 were unansweredâ€”let me know if you want those carved out or expanded further.

---

_**User (2025-11-14 08:30Z)**_

/speckit.analyze 

--- Cursor Command: speckit.analyze.md ---
---
description: Perform a non-destructive cross-artifact consistency and quality analysis across spec.md, plan.md, and tasks.md after task generation.
---

## User Input

```text
$ARGUMENTS
```

You **MUST** consider the user input before proceeding (if not empty).

## Goal

Identify inconsistencies, duplications, ambiguities, and underspecified items across the three core artifacts (`spec.md`, `plan.md`, `tasks.md`) before implementation. This command MUST run only after `/speckit.tasks` has successfully produced a complete `tasks.md`.

## Operating Constraints

**STRICTLY READ-ONLY**: Do **not** modify any files. Output a structured analysis report. Offer an optional remediation plan (user must explicitly approve before any follow-up editing commands would be invoked manually).

**Constitution Authority**: The project constitution (`.specify/memory/constitution.md`) is **non-negotiable** within this analysis scope. Constitution conflicts are automatically CRITICAL and require adjustment of the spec, plan, or tasksâ€”not dilution, reinterpretation, or silent ignoring of the principle. If a principle itself needs to change, that must occur in a separate, explicit constitution update outside `/speckit.analyze`.

## Execution Steps

### 1. Initialize Analysis Context

Run `.specify/scripts/bash/check-prerequisites.sh --json --require-tasks --include-tasks` once from repo root and parse JSON for FEATURE_DIR and AVAILABLE_DOCS. Derive absolute paths:

- SPEC = FEATURE_DIR/spec.md
- PLAN = FEATURE_DIR/plan.md
- TASKS = FEATURE_DIR/tasks.md

Abort with an error message if any required file is missing (instruct the user to run missing prerequisite command).
For single quotes in args like "I'm Groot", use escape syntax: e.g 'I'\''m Groot' (or double-quote if possible: "I'm Groot").

### 2. Load Artifacts (Progressive Disclosure)

Load only the minimal necessary context from each artifact:

**From spec.md:**

- Overview/Context
- Functional Requirements
- Non-Functional Requirements
- User Stories
- Edge Cases (if present)

**From plan.md:**

- Architecture/stack choices
- Data Model references
- Phases
- Technical constraints

**From tasks.md:**

- Task IDs
- Descriptions
- Phase grouping
- Parallel markers [P]
- Referenced file paths

**From constitution:**

- Load `.specify/memory/constitution.md` for principle validation

### 3. Build Semantic Models

Create internal representations (do not include raw artifacts in output):

- **Requirements inventory**: Each functional + non-functional requirement with a stable key (derive slug based on imperative phrase; e.g., "User can upload file" â†’ `user-can-upload-file`)
- **User story/action inventory**: Discrete user actions with acceptance criteria
- **Task coverage mapping**: Map each task to one or more requirements or stories (inference by keyword / explicit reference patterns like IDs or key phrases)
- **Constitution rule set**: Extract principle names and MUST/SHOULD normative statements

### 4. Detection Passes (Token-Efficient Analysis)

Focus on high-signal findings. Limit to 50 findings total; aggregate remainder in overflow summary.

#### A. Duplication Detection

- Identify near-duplicate requirements
- Mark lower-quality phrasing for consolidation

#### B. Ambiguity Detection

- Flag vague adjectives (fast, scalable, secure, intuitive, robust) lacking measurable criteria
- Flag unresolved placeholders (TODO, TKTK, ???, `<placeholder>`, etc.)

#### C. Underspecification

- Requirements with verbs but missing object or measurable outcome
- User stories missing acceptance criteria alignment
- Tasks referencing files or components not defined in spec/plan

#### D. Constitution Alignment

- Any requirement or plan element conflicting with a MUST principle
- Missing mandated sections or quality gates from constitution

#### E. Coverage Gaps

- Requirements with zero associated tasks
- Tasks with no mapped requirement/story
- Non-functional requirements not reflected in tasks (e.g., performance, security)

#### F. Inconsistency

- Terminology drift (same concept named differently across files)
- Data entities referenced in plan but absent in spec (or vice versa)
- Task ordering contradictions (e.g., integration tasks before foundational setup tasks without dependency note)
- Conflicting requirements (e.g., one requires Next.js while other specifies Vue)

### 5. Severity Assignment

Use this heuristic to prioritize findings:

- **CRITICAL**: Violates constitution MUST, missing core spec artifact, or requirement with zero coverage that blocks baseline functionality
- **HIGH**: Duplicate or conflicting requirement, ambiguous security/performance attribute, untestable acceptance criterion
- **MEDIUM**: Terminology drift, missing non-functional task coverage, underspecified edge case
- **LOW**: Style/wording improvements, minor redundancy not affecting execution order

### 6. Produce Compact Analysis Report

Output a Markdown report (no file writes) with the following structure:

## Specification Analysis Report

| ID | Category | Severity | Location(s) | Summary | Recommendation |
|----|----------|----------|-------------|---------|----------------|
| A1 | Duplication | HIGH | spec.md:L120-134 | Two similar requirements ... | Merge phrasing; keep clearer version |

(Add one row per finding; generate stable IDs prefixed by category initial.)

**Coverage Summary Table:**

| Requirement Key | Has Task? | Task IDs | Notes |
|-----------------|-----------|----------|-------|

**Constitution Alignment Issues:** (if any)

**Unmapped Tasks:** (if any)

**Metrics:**

- Total Requirements
- Total Tasks
- Coverage % (requirements with >=1 task)
- Ambiguity Count
- Duplication Count
- Critical Issues Count

### 7. Provide Next Actions

At end of report, output a concise Next Actions block:

- If CRITICAL issues exist: Recommend resolving before `/speckit.implement`
- If only LOW/MEDIUM: User may proceed, but provide improvement suggestions
- Provide explicit command suggestions: e.g., "Run /speckit.specify with refinement", "Run /speckit.plan to adjust architecture", "Manually edit tasks.md to add coverage for 'performance-metrics'"

### 8. Offer Remediation

Ask the user: "Would you like me to suggest concrete remediation edits for the top N issues?" (Do NOT apply them automatically.)

## Operating Principles

### Context Efficiency

- **Minimal high-signal tokens**: Focus on actionable findings, not exhaustive documentation
- **Progressive disclosure**: Load artifacts incrementally; don't dump all content into analysis
- **Token-efficient output**: Limit findings table to 50 rows; summarize overflow
- **Deterministic results**: Rerunning without changes should produce consistent IDs and counts

### Analysis Guidelines

- **NEVER modify files** (this is read-only analysis)
- **NEVER hallucinate missing sections** (if absent, report them accurately)
- **Prioritize constitution violations** (these are always CRITICAL)
- **Use examples over exhaustive rules** (cite specific instances, not generic patterns)
- **Report zero issues gracefully** (emit success report with coverage statistics)

## Context

$ARGUMENTS

--- End Command ---

---

_**Agent (model gpt-5.1-codex, mode Agent)**_

<think><details><summary>Thought Process</summary>
**Running prerequisite script**</details></think>

---

<tool-use data-tool-type="bash" data-tool-name="run_terminal_cmd">
<details><summary>Tool use: **command** â€¢ Run command: cd '/Users/david_atlarge/Local Sites/speckit-eval/app' && .specify/scripts/bash/check-prerequisites.sh --json --require-tasks --include-tasks</summary>

```bash
cd '/Users/david_atlarge/Local Sites/speckit-eval/app' && .specify/scripts/bash/check-prerequisites.sh --json --require-tasks --include-tasks
```

```
{&quot;FEATURE_DIR&quot;:&quot;/Users/david_atlarge/Local Sites/speckit-eval/app/specs/001-cookie-consent&quot;,&quot;AVAILABLE_DOCS&quot;:[&quot;research.md&quot;,&quot;data-model.md&quot;,&quot;contracts/&quot;,&quot;quickstart.md&quot;,&quot;tasks.md&quot;]}

```
</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Preparing to review specification files**</details></think>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** â€¢ Read file: /Users/david_atlarge/Local Sites/speckit-eval/app/specs/001-cookie-consent/tasks.md</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Identifying missing constitution file**</details></think>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** â€¢ Read file: /Users/david_atlarge/Local Sites/speckit-eval/app/.specify/memory/constitution.md</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Summarizing specification coverage and gaps**

This is a detailed analysis of how the projectâ€™s functional requirements, success criteria, and edge cases are covered by tasks, noting specific coverage gaps like cookie detection and JS-disabled fallback, ambiguities, and some missing test measurements. Iâ€™m preparing a coverage table mapping each spec key to its related tasks and marking gaps with severity levels, plus compiling a findings list and overall coverage metrics before proposing next steps.
**Detailing requirement task coverage stats**

Iâ€™m finalizing the list of requirements with yes/no task coverage and recalculating the total coverage percentage as about 74%. Now Iâ€™ll prepare the comprehensive table of all 31 requirements and package this data into a clear final report referencing spec sections and related plans or tasks.</details></think>

---

## Specification Analysis Report

| ID | Category | Severity | Location(s) | Summary | Recommendation |
|----|----------|----------|-------------|---------|----------------|
| G1 | Coverage Gap | HIGH | `spec.md` Â§FR-011, `plan.md` â€œCore classesâ€, `tasks.md` (no detection task) | Requirement to â€œdetect all cookies set by the site and third-party integrationsâ€ has no architectural or task coverage beyond generic script wrapping, leaving automated discovery undocumented. | Add plan + task entries for cookie auto-detection (scanner, admin review queue) and trace them back to FR-011. |
| G2 | Coverage Gap | HIGH | `spec.md` Edge Cases (â€œJavaScript disabledâ€), `tasks.md` (absent) | Required fallback UI/message for no-JS visitors isnâ€™t planned or scheduled, risking constitutional compliance (WordPress UX) and legal notice obligations. | Document fallback behavior in plan/spec addendum and add tasks for static banner markup + PHP fallback rendering. |
| G3 | Coverage Gap | MEDIUM | `spec.md` Â§SC-002, `tasks.md` Phase 7 | â€œUsers can complete consent decision in under 10 secondsâ€ lacks instrumentation or usability-validation tasks; only load/perf checks exist. | Add usability validation task (timed UX test or telemetry) and define measurement approach in plan. |
| G4 | Coverage Gap | MEDIUM | `spec.md` Â§SC-004, `tasks.md` | No task validates the â€œaccess preferences within 3 clicks from any pageâ€ constraint; implementation may satisfy it accidentally or not at all. | Create design review + automated nav test task to confirm click depth and document expectation in plan. |
| G5 | Coverage Gap | MEDIUM | `spec.md` Â§SC-008, `tasks.md` | Requirement that rejecting cookies preserves core functionality is never referenced in tasks/tests, so regressions here would go unnoticed. | Add regression test (manual or automated) ensuring core Etch pages still work with all non-essential cookies disabled. |
| G6 | Coverage Gap | MEDIUM | `spec.md` Edge Cases (â€œclears browser dataâ€), `tasks.md` | Behavior when visitors clear cookies/storage isnâ€™t covered; no task ensures banner reappears with correct messaging/version handling. | Extend storage-manager tasks to include reset detection + add test mirroring quickstart scenario for cleared storage. |
| G7 | Coverage Gap | LOW | `spec.md` Edge Cases (â€œmultiple devicesâ€), `tasks.md` | Specification says consent is device-specific, but tasks never mention device-differentiated storage or documentation of that behavior. | Clarify in plan that consent is per-device and add documentation task (e.g., FAQ copy) so users/site owners know limitation. |
| G8 | Ambiguity | MEDIUM | `spec.md` User Storyâ€¯1 & Â§SC-003 | â€œBanner dismissed permanentlyâ€ conflicts with â€œre-prompt after 12 months or when policy changesâ€; tasks donâ€™t resolve precedence. | Update spec to define precedence (policy change and expiry override â€œpermanentâ€) and ensure tasks (T058/T039) implement that rule. |

### Coverage Summary

| Requirement Key | Has Task? | Task IDs | Notes |
|-----------------|-----------|----------|-------|
| banner-before-cookies (FR-001) | Yes | T026,T035,T037 | Banner + gating tasks present |
| accept-reject-options (FR-002) | Yes | T026,T028 | Buttons + logic |
| block-non-essential (FR-003) | Yes | T023,T029,T031 | Blocking + tests |
| persist-consent (FR-004) | Yes | T030,T039 | Storage + TTL |
| cookie-categories (FR-005) | Yes | T014,T049 | Seed + API |
| cookie-details-display (FR-006) | Yes | T043,T049 | Modal + payload |
| per-category-consent (FR-007) | Yes | T047,T048 | Toggles + save |
| preference-manager-access (FR-008) | Yes | T036,T053 | Footer link + API |
| modify-consent-anytime (FR-009) | Yes | T054,T055 | Update/revoke APIs |
| clear-rejected-cookies (FR-010) | Yes | T038,T052 | Cleanup logic/tests |
| detect-all-cookies (FR-011) | **No** | â€” | No detection/scanning task (See G1) |
| admin-cookie-dashboard (FR-011a) | Yes | T061â€“T079 | Admin UI + endpoints |
| respect-dnt (FR-012) | Yes | T034,T090 | Endpoint + test |
| consent-logging (FR-013) | Yes | T016,T024,T084 | Logger + retention |
| re-prompt-changes (FR-014) | Yes | T058 | Consent versioning |
| banner-layout (FR-015) | Yes | T026,T027 | UI + BEM |
| first-visit-banner-100 (SC-001) | Yes | T023,T026 | Tests + UI |
| decision-under-10s (SC-002) | **No** | â€” | No usability metric task |
| consent-persists-12mo (SC-003) | Yes | T039,T091 | TTL logic + test |
| preferences-three-clicks (SC-004) | **No** | â€” | No measurement (See G4) |
| cookie-details-complete (SC-005) | Yes | T043,T049 | Modal + API |
| banner-load-under-1s (SC-006) | Yes | T089 | Perf validation |
| blocking-accuracy-100 (SC-007) | Yes | T023,T029 | Tests + blocker |
| reject-retains-core-functionality (SC-008) | **No** | â€” | No negative-path validation |
| mobile-accessibility (SC-009) | Yes | T027,T050,T088 | Styles + device test |
| audit-logs-100 (SC-010) | Yes | T016,T024,T084 | Logger + cleanup |
| fallback-no-js (Edge) | **No** | â€” | Missing fallback implementation |
| browser-data-cleared (Edge) | **No** | â€” | No reset handling |
| multi-device-state (Edge) | **No** | â€” | No device-scoped comms |
| third-party-embedded-blocking (Edge) | Yes | T029,T031 | Blocker covers |
| purpose-change-reprompt (Edge) | Yes | T058 | Version mismatch flow |

**Constitution Alignment Issues:** None detected; WordPress standards, AutomaticCSS, integration testing, and migration discipline are all referenced in tasks/plan.

**Unmapped Tasks:** Noneâ€”every listed task ties to at least one requirement, success criterion, or constitution mandate.

### Metrics

- Total requirements assessed: 31
- Total tasks: 99
- Coverage: 23/31 requirements with â‰¥1 task (74%)
- Ambiguity findings: 1
- Duplication findings: 0
- Critical issues: 0 (but 2 high-severity gaps)

### Next Actions

- Address High severity gaps (cookie detection, no-JS fallback) before `/speckit.implement` to avoid shipping an incomplete compliance baseline.
- Add measurement/validation tasks for usability-focused success criteria (SC-002, SC-004, SC-008) to raise coverage above 90%.
- Clarify dismissal vs. re-prompt precedence in `spec.md`, then propagate to plan/tasks so engineers implement consistent behavior.

David, would you like me to propose concrete remediation edits for the top issues (e.g., draft new tasks or spec clarifications)?

---

